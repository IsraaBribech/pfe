<!-- admin.component.html -->
<div class="admin-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <span class="logo-icon">A</span>
          <span class="logo-text">AdminDash</span>
        </div>
        <div class="admin-info">
          <div class="admin-avatar"></div>
          <div class="admin-details">
            <h3>malak</h3>
            <p>meeleek0909gmail.com</p>
          </div>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <ul>
          <li routerLink="/admin"><i class="fas fa-tachometer-alt"></i> Tableau de bord</li>
          <li routerLink="/utilisateurs"><i class="fas fa-users"></i> Utilisateurs</li>
          <li routerLink="/niveaux"><i class="fas fa-layer-group"></i> Niveaux</li>
          <li routerLink="/specialites"><i class="fas fa-graduation-cap"></i> Spécialités</li>
          <li routerLink="/regimes"><i class="fas fa-book"></i> Régimes</li>
          <li routerLink="/departements"><i class="fas fa-building"></i> Départements</li>
          <li routerLink="/cours"><i class="fas fa-book-open"></i> Cours</li>
          <li routerLink="/notifications"><i class="fas fa-bell"></i> Envoyer Notification</li>
        </ul>
      </nav>
      
    </aside>
  
    <!-- Main Content Area -->
    <main class="main-content">
      <header class="content-header">
        <div class="header-title"></div>
        <div class="header-actions">
          <div class="search-bar">
            <input type="text" placeholder="Rechercher...">
            <i class="fas fa-search"></i>
          </div>
          <div class="notification-icon">
            <i class="fas fa-bell"></i>
            <span class="badge">3</span>
          </div>
        </div>
      </header>
  
      <!-- Dashboard Section -->
      <div class="content-body">
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon users"><i class="fas fa-users"></i></div>
            <div class="stat-info">
              <p>Utilisateurs</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon levels"><i class="fas fa-layer-group"></i></div>
            <div class="stat-info">
              <p>Niveaux</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon specialties"><i class="fas fa-graduation-cap"></i></div>
            <div class="stat-info">
              <p>Spécialités</p>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon departments"><i class="fas fa-building"></i></div>
            <div class="stat-info">
              <p>Départements</p>
            </div>
          </div>

        </div>

        
  
        <div class="quick-actions">
          <h2>Actions rapides</h2>
          <div class="actions-grid">
            <button (click)="showModal('user')">
              <i class="fas fa-user-plus"></i>
              Ajouter un Enseignant
            </button>
            <button (click)="showModal('user')">
              <i class="fas fa-user-plus"></i>
              Ajouter un Etudiant
            </button>
            <button (click)="showModal('level')">
              <i class="fas fa-plus-circle"></i>
              Ajouter un niveau
            </button>
            <button (click)="showModal('specialty')">
              <i class="fas fa-plus-circle"></i>
              Ajouter une spécialité
            </button>
            <button (click)="showModal('department')">
              <i class="fas fa-plus-circle"></i>
              Ajouter un département
            </button>
          </div>
        </div>
      </div>
  
     <br>

      <div class="stats-section">
        <h2>Statistiques</h2>
        
        <div class="stats-cards">
          <div class="stat-card">
            <div class="stat-icon users"><i class="fas fa-users"></i></div>
            <div class="stat-info">
              <h3>{{ userStats.total }}</h3>
              <p>Utilisateurs</p>
              <div class="stat-trend up">
                <i class="fas fa-arrow-up"></i>
                <span>{{ userStats.growth }}%</span>
              </div>
            </div>
            <div class="stat-chart">
              <div class="mini-chart" [ngStyle]="{'--percentage': userStats.chart + '%'}"></div>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon levels"><i class="fas fa-layer-group"></i></div>
            <div class="stat-info">
              <h3>{{ levelStats.total }}</h3>
              <p>Niveaux</p>
              <div class="stat-trend up">
                <i class="fas fa-arrow-up"></i>
                <span>{{ levelStats.growth }}%</span>
              </div>
            </div>
            <div class="stat-chart">
              <div class="mini-chart" [ngStyle]="{'--percentage': levelStats.chart + '%'}"></div>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon specialties"><i class="fas fa-graduation-cap"></i></div>
            <div class="stat-info">
              <h3>{{ specialtyStats.total }}</h3>
              <p>Spécialités</p>
              <div class="stat-trend down">
                <i class="fas fa-arrow-down"></i>
                <span>{{ specialtyStats.growth }}%</span>
              </div>
            </div>
            <div class="stat-chart">
              <div class="mini-chart" [ngStyle]="{'--percentage': specialtyStats.chart + '%'}"></div>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon departments"><i class="fas fa-building"></i></div>
            <div class="stat-info">
              <h3>{{ departmentStats.total }}</h3>
              <p>Départements</p>
              <div class="stat-trend up">
                <i class="fas fa-arrow-up"></i>
                <span>{{ departmentStats.growth }}%</span>
              </div>
            </div>
            <div class="stat-chart">
              <div class="mini-chart" [ngStyle]="{'--percentage': departmentStats.chart + '%'}"></div>
            </div>
          </div>
        </div>
        
        <!-- Graphiques détaillés -->
        <div class="detailed-stats">
          <div class="chart-container">
            <div class="chart-header">
              <h3>Répartition des utilisateurs</h3>
              <div class="chart-actions">
                <button class="chart-period-btn active">7 jours</button>
                <button class="chart-period-btn">30 jours</button>
                <button class="chart-period-btn">Année</button>
              </div>
            </div>
            <div class="user-distribution-chart">
              <div class="chart-bars">
                <div *ngFor="let item of userDistribution" class="chart-bar-item">
                  <div class="chart-label">{{ item.label }}</div>
                  <div class="chart-bar-container">
                    <div class="chart-bar" [ngStyle]="{'height': item.percentage + '%'}"></div>
                  </div>
                  <div class="chart-value">{{ item.value }}</div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="chart-container">
            <div class="chart-header">
              <h3>Spécialités par département</h3>
            </div>
            <div class="pie-chart-container">
              <div class="pie-chart">
                <div *ngFor="let slice of deptSpecialties; let i = index" 
                    class="pie-slice" 
                    [ngStyle]="{
                      'background-image': 'conic-gradient(var(--color-' + (i+1) + ') ' + slice.percentage + '%, transparent ' + slice.percentage + '%)'
                    }">
                </div>
                <div class="pie-center">{{ deptSpecialties.length }}</div>
              </div>
              <div class="pie-legend">
                <div *ngFor="let slice of deptSpecialties; let i = index" class="legend-item">
                  <div class="legend-color" [ngStyle]="{'background-color': 'var(--color-' + (i+1) + ')'}"></div>
                  <div class="legend-label">{{ slice.name }}</div>
                  <div class="legend-value">{{ slice.value }}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Activité récente -->
        <div class="recent-activity">
          <div class="section-header">
            <h3>Activité récente</h3>
            <button class="view-all-btn">
              Voir tout <i class="fas fa-chevron-right"></i>
            </button>
          </div>
        
          <div class="activity-list" *ngIf="recentActivities.length > 0; else noActivity">
            <div *ngFor="let activity of recentActivities" class="activity-item">
              <div class="activity-icon" 
                  [ngClass]="{
                    'user-activity': activity.type === 'user',
                    'level-activity': activity.type === 'level',
                    'specialty-activity': activity.type === 'specialty',
                    'department-activity': activity.type === 'department'
                  }">
                <i class="fas" 
                  [ngClass]="{
                    'fa-user': activity.type === 'user',
                    'fa-layer-group': activity.type === 'level',
                    'fa-graduation-cap': activity.type === 'specialty',
                    'fa-building': activity.type === 'department'
                  }">
                </i>
              </div>
              <div class="activity-details">
                <div class="activity-text">{{ activity.text }}</div>
                <div class="activity-time">{{ activity.time }}</div>
              </div>
            </div>
          </div>
        
          <ng-template #noActivity>
            <p class="text-muted">Aucune activité récente.</p>
          </ng-template>
        </div>
        
      </div>



  
  <!-- Formulaire Modal pour les Utilisateurs -->
  <div class="modal-overlay" *ngIf="activeModal === 'user'">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Ajouter un utilisateur</h2>
        <button class="close-button" (click)="hideModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="userForm" (ngSubmit)="submitForm('user')">
          <div class="form-group">
            <label for="userName">Nom complet</label>
            <input type="text" id="userName" formControlName="name" placeholder="Entrez le nom complet">
          </div>
          <div class="form-group">
            <label for="userCin">Cin</label>
            <input type="text" id="userCin" formControlName="cin" placeholder="Entrez votre Cin">
          </div>
          <div class="form-group">
            <label for="userEmail">Email</label>
            <input type="email" id="userEmail" formControlName="email" placeholder="Entrez l'adresse email">
          </div>
          <div class="form-group">
            <label for="userType">utilisateur</label>
            <select id="userType" formControlName="level">
              <option value="">Sélectionnez le type  </option>
              <option value="1">Enseignant</option>
              <option value="2">Etudiant</option>
            </select>
          </div>
          <div class="form-group">
            <label for="userPassword">Mot de passe</label>
            <input type="password" id="userPassword" formControlName="password" placeholder="Entrez le mot de passe">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
            <button type="submit" class="btn-primary" [disabled]="userForm.invalid">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Formulaire Modal pour les Niveaux -->
  <div class="modal-overlay" *ngIf="activeModal === 'level'">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Ajouter un niveau</h2>
        <button class="close-button" (click)="hideModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="levelForm" (ngSubmit)="submitForm('level')">
          <div class="form-group">
            <label for="levelName">Nom du niveau</label>
            <input type="text" id="levelName" formControlName="name" placeholder="Entrez le nom du niveau">
          </div>
          <div class="form-group">
            <label for="levelDescription">Description</label>
            <textarea id="levelDescription" formControlName="description" placeholder="Entrez une description"></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
            <button type="submit" class="btn-primary" [disabled]="levelForm.invalid">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Formulaire Modal pour les Spécialités -->
  <div class="modal-overlay" *ngIf="activeModal === 'specialty'">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Ajouter une spécialité</h2>
        <button class="close-button" (click)="hideModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="specialtyForm" (ngSubmit)="submitForm('specialty')">
          <div class="form-group">
            <label for="specialtyName">Nom de la spécialité</label>
            <input type="text" id="specialtyName" formControlName="name" placeholder="Entrez le nom de la spécialité">
          </div>
          <div class="form-group">
            <label for="specialtyDescription">Description</label>
            <textarea id="specialtyDescription" formControlName="description" placeholder="Entrez une description"></textarea>
          </div>
          <div class="form-group">
            <label for="specialtyDepartment">Département</label>
            <select id="specialtyDepartment" formControlName="department">
              <option value="">Sélectionnez un département</option>
              <option *ngFor="let dept of departments" [value]="dept.id">
                {{dept.name}}
              </option>
            </select>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
            <button type="submit" class="btn-primary" [disabled]="specialtyForm.invalid">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Formulaire Modal pour les Régimes -->
  <div class="modal-overlay" *ngIf="activeModal === 'regime'">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Ajouter un régime</h2>
        <button class="close-button" (click)="hideModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="regimeForm" (ngSubmit)="submitForm('regime')">
          <div class="form-group">
            <label for="regimeName">Nom du régime</label>
            <input type="text" id="regimeName" formControlName="name" placeholder="Entrez le nom du régime">
          </div>
          <div class="form-group">
            <label for="regimeDescription">Description</label>
            <textarea id="regimeDescription" formControlName="description" placeholder="Entrez une description"></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
            <button type="submit" class="btn-primary" [disabled]="regimeForm.invalid">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Formulaire Modal pour les Départements -->
  <div class="modal-overlay" *ngIf="activeModal === 'department'">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Ajouter un département</h2>
        <button class="close-button" (click)="hideModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="departmentForm" (ngSubmit)="submitForm('department')">
          <div class="form-group">
            <label for="departmentName">Nom du département</label>
            <input type="text" id="departmentName" formControlName="name" placeholder="Entrez le nom du département">
          </div>
          <div class="form-group">
            <label for="departmentDescription">Description</label>
            <textarea id="departmentDescription" formControlName="description" placeholder="Entrez une description"></textarea>
          </div>
          <div class="form-group">
            <label for="departmentHead">Chef Département</label>
            <input type="text" id="departmentHead" formControlName="head" placeholder="Entrez le nom du responsable">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
            <button type="submit" class="btn-primary" [disabled]="departmentForm.invalid">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>
  </div>