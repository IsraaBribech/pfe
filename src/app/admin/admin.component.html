<!-- admin.component.html -->
<div class="admin-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">
        <span class="logo-icon">A</span>
        <span class="logo-text">AdminDash</span>
      </div>
      <div class="admin-info">
        <div class="admin-avatar"></div>
        <div class="admin-details">
          <h3>malak</h3>
          <p>meeleek0909gmail.com</p>
        </div>
      </div>
    </div>
    
    <nav class="sidebar-nav">
      <ul>
        <li routerLink="/admin"><i class="fas fa-tachometer-alt"></i> Tableau de bord</li>
        <li class="has-submenu">
          <div class="menu-item" (click)="toggleSubmenu($event)">
            <i class="fas fa-users"></i> Utilisateurs <i class="fas fa-chevron-down submenu-icon"></i>
          </div>
          <ul class="submenu">
            <li routerLink="/enseignants"><i class="fas fa-chalkboard-teacher"></i> Enseignants</li>
            <li routerLink="/etudiants"><i class="fas fa-user-graduate"></i> Etudiants</li>
          </ul>
        </li>
        <li routerLink="/niveaux"><i class="fas fa-layer-group"></i> Niveaux</li>
        <li routerLink="/specialites"><i class="fas fa-graduation-cap"></i> Spécialités</li>
        <li routerLink="/regimes"><i class="fas fa-book"></i> Régimes</li>
        <li routerLink="/departements"><i class="fas fa-building"></i> Départements</li>
        <li routerLink="/cours"><i class="fas fa-book-open"></i> Cours</li>
        <li routerLink="/notifications"><i class="fas fa-bell"></i> Envoyer Notification</li>
      </ul>
    </nav>
  </aside>

  <!-- Main Content Area -->
  <main class="main-content">
    <header class="content-header">
      <div class="header-title"></div>
      <div class="header-actions">
        <div class="search-bar">
          <input type="text" placeholder="Rechercher...">
          <i class="fas fa-search"></i>
        </div>
        <div class="notification-icon">
          <i class="fas fa-bell"></i>
          <span class="badge">3</span>
        </div>
      </div>
    </header>

    <!-- Dashboard Section -->
    <div class="content-body">
      <div class="stats-cards">
        <div class="stat-card">
          <div class="stat-icon users"><i class="fas fa-users"></i></div>
          <div class="stat-info">
            <p>Utilisateurs</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon levels"><i class="fas fa-layer-group"></i></div>
          <div class="stat-info">
            <p>Niveaux</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon specialties"><i class="fas fa-graduation-cap"></i></div>
          <div class="stat-info">
            <p>Spécialités</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon departments"><i class="fas fa-building"></i></div>
          <div class="stat-info">
            <p>Départements</p>
          </div>
        </div>

      </div>

      

      <div class="quick-actions">
        <h2>Actions rapides</h2>
        <div class="actions-grid">
          <button (click)="showModal('user')">
            <i class="fas fa-chalkboard-teacher"></i>
            Ajouter un Enseignant
          </button>
          <button (click)="showModal('user')">
            <i class="fas fa-user-graduate"></i>
            Ajouter un Etudiant
          </button>
          <button (click)="showModal('level')">
            <i class="fas fa-plus-circle"></i>
            Ajouter un niveau
          </button>
          <button (click)="showModal('specialty')">
            <i class="fas fa-plus-circle"></i>
            Ajouter une spécialité
          </button>
          <button (click)="showModal('department')">
            <i class="fas fa-plus-circle"></i>
            Ajouter un département
          </button>
        </div>
      </div>
    </div>

   <br>

    <div class="stats-section">
      <h2>Statistiques</h2>
      
      <div class="stats-cards">
        <div class="stat-card">
          <div class="stat-icon users"><i class="fas fa-users"></i></div>
          <div class="stat-info">
            <h3>{{ userStats.total }}</h3>
            <p>Utilisateurs</p>
           
          </div>
         
        </div>
        
        <div class="stat-card">
          <div class="stat-icon levels"><i class="fas fa-layer-group"></i></div>
          <div class="stat-info">
            <h3>{{ levelStats.total }}</h3>
            <p>Niveaux</p>
           
          </div>
        
        </div>
        
        <div class="stat-card">
          <div class="stat-icon specialties"><i class="fas fa-graduation-cap"></i></div>
          <div class="stat-info">
            <h3>{{ specialtyStats.total }}</h3>
            <p>Spécialités</p>
           
          </div>
      
        </div>
        
        <div class="stat-card">
          <div class="stat-icon departments"><i class="fas fa-building"></i></div>
          <div class="stat-info">
            <h3>{{ departmentStats.total }}</h3>
            <p>Départements</p>
           
      
       
           
        </div>
      </div>
      
  
      
    




<!-- Formulaire Modal pour les Utilisateurs -->
<!-- Formulaire Modal pour les Utilisateurs -->
<div class="modal-overlay" *ngIf="activeModal === 'user'">
<div class="modal-container">
  <div class="modal-header">
    <h2>Ajouter un utilisateur</h2>
    <button class="close-button" (click)="hideModal()">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="userForm" (ngSubmit)="submitForm('user')">
      <div class="form-group">
        <label for="userName">Nom complet</label>
        <input type="text" id="userName" formControlName="name" placeholder="Entrez le nom complet">
      </div>
      <div class="form-group">
        <label for="userCin">Cin</label>
        <input type="text" id="userCin" formControlName="cin" placeholder="Entrez votre Cin">
      </div>
      <div class="form-group">
        <label for="userEmail">Email</label>
        <input type="email" id="userEmail" formControlName="email" placeholder="Entrez l'adresse email">
      </div>
      <div class="form-group">
        <label for="userType">Type d'utilisateur</label>
        <select id="userType" formControlName="level">
          <option value="">Sélectionnez le type</option>
          <option *ngFor="let niveau of niveaux" [value]="niveau.id || niveau._id">
            {{ niveau.name }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label for="userDepartment">Département</label>
        <select id="userDepartment" formControlName="department">
          <option value="">Sélectionnez le département</option>
          <option *ngFor="let dept of departments" [value]="dept.id || dept._id">
            {{ dept.name }}
          </option>
        </select>
        <!-- Bouton pour charger manuellement les spécialités -->
        <button type="button" class="btn-secondary btn-sm" 
                *ngIf="userForm.get('department')?.value" 
                (click)="loadSpecialtiesForDepartment(userForm.get('department')?.value)">
          Charger les spécialités
        </button>
      </div>
      <div class="form-group">
        <label for="userSpecialty">Spécialité</label>
        <select id="userSpecialty" formControlName="specialty" [disabled]="!userForm.get('department')?.value || filteredSpecialties.length === 0">
          <option value="">{{ filteredSpecialties.length === 0 ? 'Aucune spécialité disponible' : 'Sélectionnez la spécialité' }}</option>
          <option *ngFor="let spec of filteredSpecialties" [value]="spec.id || spec._id">
            {{ spec.name }}
          </option>
        </select>
      </div>
      <div class="form-group">
        <label for="userPassword">Mot de passe</label>
        <input type="password" id="userPassword" formControlName="password" placeholder="Entrez le mot de passe">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
        <button type="submit" class="btn-primary" [disabled]="userForm.invalid">Enregistrer</button>
      </div>
    </form>
  </div>
</div>
</div>

<!-- Formulaire Modal pour les Niveaux -->
<div class="modal-overlay" *ngIf="activeModal === 'level'">
  <div class="modal-container">
    <div class="modal-header">
      <h2>Ajouter un niveau</h2>
      <button class="close-button" (click)="hideModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="levelForm" (ngSubmit)="submitForm('level')">
        <div class="form-group">
          <label for="levelName">Nom du niveau</label>
          <input type="text" id="levelName" formControlName="name" placeholder="Entrez le nom du niveau">
        </div>
        <div class="form-group">
          <label for="levelDescription">Description</label>
          <textarea id="levelDescription" formControlName="description" placeholder="Entrez une description"></textarea>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
          <button type="submit" class="btn-primary" [disabled]="levelForm.invalid">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Formulaire Modal pour les Spécialités -->
<div class="modal-overlay" *ngIf="activeModal === 'specialty'">
  <div class="modal-container">
    <div class="modal-header">
      <h2>Ajouter une spécialité</h2>
      <button class="close-button" (click)="hideModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="specialtyForm" (ngSubmit)="submitForm('specialty')">
        <div class="form-group">
          <label for="specialtyName">Nom de la spécialité</label>
          <input type="text" id="specialtyName" formControlName="name" placeholder="Entrez le nom de la spécialité">
        </div>
        <div class="form-group">
          <label for="specialtyDescription">Description</label>
          <textarea id="specialtyDescription" formControlName="description" placeholder="Entrez une description"></textarea>
        </div>
        <div class="form-group">
          <label for="specialtyDepartment">Département</label>
          <select id="specialtyDepartment" formControlName="department">
            <option value="">Sélectionnez un département</option>
            <option *ngFor="let dept of departments" [value]="dept.id">
              {{dept.name}}
            </option>
          </select>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
          <button type="submit" class="btn-primary" [disabled]="specialtyForm.invalid">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Formulaire Modal pour les Régimes -->
<div class="modal-overlay" *ngIf="activeModal === 'regime'">
  <div class="modal-container">
    <div class="modal-header">
      <h2>Ajouter un régime</h2>
      <button class="close-button" (click)="hideModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="regimeForm" (ngSubmit)="submitForm('regime')">
        <div class="form-group">
          <label for="regimeName">Nom du régime</label>
          <input type="text" id="regimeName" formControlName="name" placeholder="Entrez le nom du régime">
        </div>
        <div class="form-group">
          <label for="regimeDescription">Description</label>
          <textarea id="regimeDescription" formControlName="description" placeholder="Entrez une description"></textarea>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
          <button type="submit" class="btn-primary" [disabled]="regimeForm.invalid">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Formulaire Modal pour les Départements -->
<div class="modal-overlay" *ngIf="activeModal === 'department'">
  <div class="modal-container">
    <div class="modal-header">
      <h2>Ajouter un département</h2>
      <button class="close-button" (click)="hideModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="departmentForm" (ngSubmit)="submitForm('department')">
        <div class="form-group">
          <label for="departmentName">Nom du département</label>
          <input type="text" id="departmentName" formControlName="name" placeholder="Entrez le nom du département">
        </div>
        <div class="form-group">
          <label for="departmentDescription">Description</label>
          <textarea id="departmentDescription" formControlName="description" placeholder="Entrez une description"></textarea>
        </div>
        <div class="form-group">
          <label for="departmentHead">Chef Département</label>
          <input type="text" id="departmentHead" formControlName="head" placeholder="Entrez le nom du responsable">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn-secondary" (click)="hideModal()">Annuler</button>
          <button type="submit" class="btn-primary" [disabled]="departmentForm.invalid">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>
</div>
